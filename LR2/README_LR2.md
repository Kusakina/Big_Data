В данной лабораторной работе необходимо было составить таблицы топ 10 языков программирования по годам (с 2010 по 2020), для формирования таблиц использовались
данные вопросов на форуме (предположительно) и список языков программирования, обработка данных происходила при помощи библиотеки pyspark.

# Ход работы:
1. создаем Спарк-сессию для работы.

![image](https://github.com/Kusakina/Big_Data/assets/74459357/4d760725-fd0d-4675-85c5-f0a2a5c9dc72)

2. Создаем переменную для хранения данных (считываем xml файл) и проверяем его наполнение (структуру)

![image](https://github.com/Kusakina/Big_Data/assets/74459357/220db492-f76b-49d8-b466-d038b1a88465)

3. Формируем таблицу, выбрав столбцы, необходимые для дальнейшего расчета. Удаляем строки с пустыми полями:

![image](https://github.com/Kusakina/Big_Data/assets/74459357/6f13a6e2-851f-4385-8717-dd4c1c59bbbc)

4. Создаем функцию для превращения строки с тегами в массив тегов для дальнейшей обработки.
    Теги содержат как название языка программирования (данные, по которым мы будем ориентироваться), так и вспомогательные данные (которые в рамках задания неинформативны).
    Применяем функцию к данным, получаем новую таблицу с разделенными тегами (массив строк).

    ![image](https://github.com/Kusakina/Big_Data/assets/74459357/55907845-330b-4880-9d29-7ca41f146d18)
   
6.  Разделяем теги, создавая дубликаты строк при помощи функции (`explode`),
    (для каждого тега из массива тегов одной строки формируем новую строку, содержащую только 1 тег и всю информацию из других колонок).

    ![image](https://github.com/Kusakina/Big_Data/assets/74459357/ca14b91b-42c6-452b-8ab3-389ce54506c7)

7.  Создаем переменную для хранения данных о языках программирования (считываем csv файл), сохраняем в новую таблицу только названия языков в нижнем регистре (так как теги в нижнем регистре).
    Переименовываем столбец, чтобы в дальнейшем можно было выполнить InnerJoin.

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/52f6c28a-e803-454c-ae7f-a9077031f981)

8. Выполняем InnerJoin двух таблиц, чтобы в таблице остались только строки, соответствующие языкам программирования (тег = = какой-то язык).
  
  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/3392f851-c10b-4533-b57e-0aa38e5f0489)

9. Я посчитала, что правильнее для оценки популярности языка учесть количество просмотров за весь период (от даты создания вопроса до даты последней активности).
   Далее будем считать, что просмотры распределены одинаково между годами (от года создания вопроса до года последней активности), то есть view_count/(_LastActivityDate -_CreationDate + 1).
   Чтобы сформировать статистику по годам, составим список годов от года создания вопроса до года последней активности, сформировав массив в одном из столбцов таблицы.

   ![image](https://github.com/Kusakina/Big_Data/assets/74459357/0aeaeaeb-f7bb-40c3-a0e3-fe4cf31cb59c)

10. Далее создадим столбец со среднем значением просмотров за каждый год (на основе массива годов).

    ![image](https://github.com/Kusakina/Big_Data/assets/74459357/efaed964-76fc-4e4a-abb9-c68dcc4de64d)

11. Аналогично пункту 6, создадим дубликаты строк, оставив в таблице только год, тег(== язык) и число посещений за год для данного вопроса.

    ![image](https://github.com/Kusakina/Big_Data/assets/74459357/93bb8fce-69f9-4fd4-adce-3637299644ce)

12. Сгруппируем таблицу по году и тегу (== языку), рассчитав суммарное значение просмотров для каждого языка программирования за каждый год.
    Отсортируем данные в порядке убывания по году и суммарному числу просмотров.

    ![image](https://github.com/Kusakina/Big_Data/assets/74459357/9b44ec44-c342-45d1-b042-cc3633d08cbf)

13.  Сформируем финальные таблицы для каждого года, отобрав первые 10 строк для каждого года.

      ![image](https://github.com/Kusakina/Big_Data/assets/74459357/0b2723bf-bf21-4d10-9fd3-b58600ef7e86)



14.  Результаты:

   ![image](https://github.com/Kusakina/Big_Data/assets/74459357/b2ed325c-0c68-48d6-917a-ea8ee7ebc1fb)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/a1c65c68-908b-4a68-b33d-03df33f2a267)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/2cbbbb91-39f6-4945-af35-c421b2e9c35b)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/d090a430-b03b-4224-bb41-0f8d69a487c0)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/fb67565b-af8a-4317-bfac-a464e01f4e7b)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/cc7d7404-088e-41e6-ac48-60bf81f22d09)

Данных для 2020 года не было, поэтому таблица пуста(


