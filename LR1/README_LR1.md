В данной лабораторной работе необходимо было выполнить задания,описанные ниже, поработав с данными аренды велосипедов при помощи библиотеки pyspark.

# Ход работы:
1. создаем Спарк-сессию для работы.
![image](https://github.com/Kusakina/Big_Data/assets/74459357/18d1f9af-a770-4861-8b86-ae5eff402e2a)

2. Создаем переменные для хранения данных (считываем csv файлы) и проверяем их наполнение (структуру)
![image](https://github.com/Kusakina/Big_Data/assets/74459357/fe66c3f7-fec8-4772-9393-d5c63c995f42)

3. Выполняем первое задание:
  ***
    Считаем суммарное время пробега для каждого велосипеда
  ***
    Находим максимальное значение суммы времени
  ***
    Находим индекс велосипеда по максимальному времени

![image](https://github.com/Kusakina/Big_Data/assets/74459357/d9fa0635-0bba-4594-9b27-2198a8d6597f)


4.  Выполняем второе задание:
  ***
    Создаем функцию для расчета расстояния
  ***
    Выбираем столбцы с широтой и долготой для создания кросс-джоина
  ***
    Выполняем кросс-джоин таблицы с данными о станциях и выбранных ранее столбцов
  ***
    Объявляем  пользовательскую функцию (используя созданную функцию для расчета расстояния), чтобы было возможно использовать её результаты для формирования данных
  ***
    Добавляем столбец - результат расчета расстояния между двумя станциями 
  ***
    Фильтруем полученные данные по убыванию расстояния, и выбираем значение расстояния из первой строки (оно максимально)

![image](https://github.com/Kusakina/Big_Data/assets/74459357/be4d95f1-5b84-459b-a8f5-3d9ed131017c)

5.Выполняем третье задание:
  ***
    Аналогично первому заданию, находим максимальное время пробега
  ***
    Находим индекс велосипеда, соответствующий максимальному времени пробега
  ***
    Формируем "обрезанную таблицу" с интересующими полями, где содержатся только записи о перемещении велосипеда с нужным индексом
  ***
    Фильтруем данные по убыванию, выбираем названия станций из первой строки (они соответствуют пути максимального пробега)

  ![image](https://github.com/Kusakina/Big_Data/assets/74459357/edadece7-11f3-4962-a0d7-8efddb681341)

    
6.Выполняем четвертое задание:
  ***
    Производим подсчет уникальных индексов велосипедов

![image](https://github.com/Kusakina/Big_Data/assets/74459357/83064036-39a2-43ca-9fc8-cf737962a15d)


7. Выполняем пятое задание:
  ***
    Рассчитываем суммарное время путешествий для каждого зип-номера и типа подписки
  ***
    фильтруем данные, согласно условию (время поездок более 3 часов)

  
   ![image](https://github.com/Kusakina/Big_Data/assets/74459357/b015ebdc-289c-4453-9fab-669baa75c490)


